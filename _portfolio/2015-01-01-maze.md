---
title: Maze PostCSS plugin
author: Cathy Dutton
layout: portfolio-post
category: portfolio
tags: Front end development, CSS, JavaScript
image: ../assets/img/portfolio/maze-cover.jpg
---

done: true
<p class="highlight-quote">
Maze is a flexible and semantic mobile first responsive grid built with PostCSS. The code is fully customisable and removes the reliance on classes like .last-column by instead applying the margin to both sides of each element and adjusting the wrapper width accordingly.
</p>


<h2 class="heading">The grid</h2>

The flexability of the grid allows it to be easily modified to suit any layout:

 - The $total-grid-columns variable is set to 12 by default but can be edited as a whole or on a row by row basis
 - The $gutter: variable is set to 2% by default but can be adjusted as a whole or on a row by row basis
 - The $fold: variable defines the way the coloumns colapse on smaller devices, It is set to left by default but can be switched to right.
 - The $push variable is set to 0 by default but can be edited as a whole or on a row by row basis
 - By default Maze works with 5 media queries and has a margin of 1%. These settings can be overridden by editing the config in the Gulp file. 

 <a href="http://cathydutton.github.io/postcss-maze/" title="Maze demo">View a demo of Maze</a>


<h2 class="heading">The CSS</h2>

Firstly the wrapper is given a property of grid-container with a value of true...

```
.wrapper {
  grid-container: true;
}
```

This calculates the wrapper width based on the values assigned to the largest and smallest media queries, and adds a clearfix.

The max width is calculated accounting for the element margins...

```
.wrapper {
  max-width: 1030.2px;
  min-width: 260px;
  margin: 0 auto;
  box-sizing: border-box;
}
 
.wrapper::after {
  content: "" ;
  display: table;
  clear: both;
}
```

Each element is then created as a ratio at a set media query...

```
.four-elements {
  col-span: mobile(1,1);
  col-span: phablet(1,2);
  col-span: tablet(1,4);
}
```

```
.four-elements {
  float: left;
  box-sizing: border-box;
  margin-right: 0.5%;
  margin-left: 0.5%;
  width: 99%;
}
 
@media only screen and (min-width:30em) {
 
  .four-elements {
    width: 49%;
  }
 
}
 
@media only screen and (min-width:48em) {
 
  .four-elements {
    width: 24%;
  }
 
}
```
 <a href="https://github.com/cathydutton/postcss-maze" title="Maze CSS">View Maze CSS</a>


<h2 class="heading">The code</h2>

Default settings taht can be overriden in a projects Gulpfile:

```
// Default Media Config
var mediaConfig = {
    mobile:  20,
    phablet: 30,
    tablet:  48,
    desktop: 63.750,
    wide:    80
};

// Default Settings Config
var settingsConfig = {
    margin: 1
};
```


```
 // Width Function
    var columnWidth = function (coloumnSpan, totalColoumns) {
        var unitWidth = totalColoumns / coloumnSpan;
        var width = (100 - unitWidth * settingsConfig.margin) / unitWidth;
        return width + '%';
    };

```

```
 // Set widths - Add to the max width to compensate for margin
    var maxWidth = mediaConfig.wide + mediaConfig.wide / 100 *
      settingsConfig.margin;
    var minWidth = mediaConfig.mobile; /* Set min width with scroll bar */
```


```
// Set up grid container
                if (prop === 'grid-container') {
                    var gridContainerCheck = /^\s*true\s*$/;

                    if (!value.match(gridContainerCheck)) {
                        throw decl.error('Syntax Error - grid-container:true', {
                            plugin: 'postcss-maze'
                        });
                    } else {
                        decl.parent.append({
                            prop:  'max-width',
                            value: maxWidth + 'em'
                        });
                        decl.parent.append({
                            prop:  'min-width',
                            value: 'calc(' + minWidth + 'em - 20px)'
                        });
                        decl.parent.append({
                            prop:  'margin',
                            value: '0 auto'
                        });
                        decl.parent.append({
                            prop:  'box-sizing',
                            value: 'border-box'
                        });
                        css.insertBefore(
                          decl.parent,
                            selectorName + '::after {' +
                            'content: "" ;' +
                            ' display: table;' +
                            'clear: both }'
                          );
                    }
                    decl.remove();
                }
```


```
// Set up grid elements
                if (prop === 'col-span') {
                    var colCheck = /^([a-z]+)(\([0-9]{1,2})(,[0-9]{1,2}\))$/;

                    if (!value.match(colCheck)) {
                        throw decl.error('Syntax Error - media(value,value)', {
                            plugin: 'postcss-maze'
                        });
                    } else {

                        // Variables
                        var split = value.split('('); // Split Media from values
                        // Media (mobile, desktop etc)
                        var chosenMedia = split[0];
                        var values = split[1]; // Grid values
                        // Remove trailing ) and split the two values (2,6)
                        var splitValues = values.slice(0, -1).split(',');
                        var span = splitValues[0]; // Col Span
                        var coloumns = splitValues[1]; // Total coloumns
                        var mediaValue = mediaConfig[chosenMedia];
                        var marginValue = settingsConfig.margin;

                        if (chosenMedia === 'mobile') {
                            decl.parent.append({
                                prop:  'float',
                                value: 'left'
                            });
                            decl.parent.append({
                                prop:  'box-sizing',
                                value: 'border-box'
                            });
                            decl.parent.append({
                                prop:  'margin-right',
                                value: marginValue / 2 + '%'
                            });
                            decl.parent.append({
                                prop:  'margin-left',
                                value: marginValue / 2 + '%'
                            });
                            decl.parent.append({
                                prop:  'width',
                                value: columnWidth(span, coloumns)
                            });
                            decl.parent.append({
                                prop:  'transition',
                                value: 'all 0.5s ease'
                            });
                        } else {
                            // add media query
                            css.insertBefore(decl.parent,
                              '@media only screen and (min-width:' +
                              mediaValue +
                              'em) { ' +
                              selectorName +
                              '{width:' +
                              columnWidth(span, coloumns) +
                              '} }');
                        }

                    }

                    decl.remove();
                }
```


 <a href="https://github.com/cathydutton/postcss-maze/blob/master/index.js" title="Maze source code">View the Maze source code</a>


```

```



```

```

```

```


